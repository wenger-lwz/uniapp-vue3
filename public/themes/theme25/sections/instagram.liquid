{% comment %}instagram{% endcomment %}
{% assign spacing = section.settings.spacing | divided_by: 2 %}
{% assign padding_top = section.settings.padding.top | default: "0" %}
{% assign padding_bottom = section.settings.padding.bottom | default: "0" %}
{% if section.settings.padding.right == blank and section.settings.padding.left == blank %}
  {% assign padding_right = section.settings.padding.right | default: settings.general_layout_spacing %}
  {% assign padding_left = section.settings.padding.left | default: settings.general_layout_spacing %}
{% else %}
  {% assign padding_right = section.settings.padding.right | default: 0 %}
  {% assign padding_left = section.settings.padding.left | default: 0 %}
{% endif %}
<style>
  .ins-{{section.id}}-container{
    max-width:{% if section.settings.max_container_width == blank %}var(--general-layout-width){% else %}{{section.settings.max_container_width}}px{% endif %};
    padding-top:{{padding_top | times: 0.6 }}px;
    padding-bottom:{{padding_bottom | times: 0.6 }}px;
  }
  @media (min-width: {{settings.breakpoint}}px) {
    .ins-{{section.id}}-container{
      padding-top:{{padding_top}}px;
      padding-right:{{padding_right}}px;
      padding-bottom:{{padding_bottom}}px;
      padding-left:{{padding_left}}px;
    }
     .ins-{{section.id}}-list-wrap{
      margin: 0 -{{spacing}}px;
    }
    .ins-{{section.id}}-item{
      padding: 0 {{spacing}}px
    }
  }
</style>
<div class="tw-text-center" style="background:{{section.settings.color_section_bg}}">
  <div class="md:tw-px-5 tw-mx-auto hide-scrollbar ins-{{section.id}}-container">
    {% unless section.settings.title == blank %}
      <h3 class="tw-mb-6 lg:tw-mb-10 tw-mt-0 tw-leading-none type-heading-font-family {%if section.settings.title_uppercase_on%}tw-uppercase{%endif%}" style="color:{{section.settings.color_title_text}};font-size: {{section.settings.title_font_size}}px;letter-spacing:{{section.settings.title_letter_spacing}}px;">
        {{section.settings.title}}
      </h3>
    {% endunless %}
    <div class="tw-group tw-relative tw-overflow-hidden ins-{{section.id}}-list-wrap">
      <div class="tw-flex tw-space-x-4 lg:tw-space-x-0 tw-overflow-x-auto ins-{{section.id}}-list">
        {% for block in section.blocks %}
          {% assign image = block.settings.image %}
          {% assign avatar = block.settings.avatar %}
          {% assign product = block.settings.product %}
          <div class="tw-w-3/4 lg:tw-w-3/12 tw-h-full tw-box-border tw-flex-shrink-0 ins-{{section.id}}-item">
            <div class="tw-border tw-border-solid tw-border-light-border-color {%if settings.general_style == 'round'%}tw-rounded-lg{%endif%} tw-overflow-hidden">
              <div class="tw-flex tw-justify-center tw-items-center tw-py-2 tw-px-4.5 ins-{{section.id}}-item-header">
                {% if block.settings.avatar != blank %}
                  <img
                    src="{{shop.default_img}}"
                    data-src="{{avatar | img_url: '60x'}}"
                    alt="{{avatar | escape}}"
                    class="tw-rounded-full tw-object-cover {%if settings.general_style == 'round'%}tw-rounded-lg{%endif%} lazyload"
                    style="width:30px;height:30px"
                  >
                {% else %}
                  <div class="tw-flex tw-justify-center tw-items-center tw-w-7.5 tw-h-7.5">
                    {% include 'icon_ins_avater' %}
                  </div>
                {% endif %}
                {% if block.settings.username %}
                  <div class="tw-pl-3 tw-leading-none tw-text-sm tw-text-title-color type-heading-font-family ins-{{section.id}}-username">{{block.settings.username}}</div>
                {% endif %}
                <div class="tw-flex-grow tw-pl-5 tw-text-right tw-text-0">{% include 'icon_instagram' %}</div>
              </div>
              <div class="tw-relative tw-pb-full ins-{{section.id}}-item-content">
                {% if image %}
                  <img
                    src="{{shop.default_img}}"
                    class="tw-absolute tw-w-full tw-h-full tw-inset-0 tw-m-auto tw-object-cover lazyload "
                    data-sizes="auto"
                    data-src="{{image | img_url: '{width}x'}}"
                    alt="{{image | escape}}" 
                  >
                {% else %}
                  {{ 'image' | placeholder_svg_tag: 'tw-block tw-absolute tw-fill-svg tw-bg-svg' }}
                {% endif %}
              </div>
              {% if product.id > 0 or shop.env == 1 %}
                {% assign is_default = false %}
                {% unless product.id > 0 %}
                  {% assign is_default = true %}
                  {% assign product = default_product %}
                {% endunless %}
                <div class="tw-flex tw-items-center tw-justify-center tw-p-4.5 ins-{{section.id}}-item-footer">
                  {% if is_default %}
                    <div style="width:46px;height:46px;">
                      {{ 'product-1' | placeholder_svg_tag: 'tw-block tw-fill-svg tw-bg-svg' }}
                    </div>
                  {% else %}
                    <img
                      src="{{shop.default_img}}"
                      class="{%if settings.general_style == 'round'%}tw-rounded-lg{%endif%} tw-object-cover lazyload "
                      style="width:46px;height:46px;"
                      data-src="{{product.thumbs | img_url: '100x'}}"
                      alt="{{product.handle | escape}}" 
                    >
                  {% endif %}
                  {% assign from_on = false %}
                  {% assign price_min = product.price %}
                  {% assign price_max = product.market_price %}
                  {% if product.market_price != product.price %}
                    {% assign from_on = true %}
                  {% endif %}
                  <div class="tw-flex-grow tw-ml-3 tw-max-w-full tw-text-left tw-truncate tw-tracking-normal tw-text-text-color tw-text-price-font-size {%if settings.type_price_same_with == 'heading'%}type-heading-font-family{%else%}type-text-font-family{%endif%} tw-leading-none">
                    {% if from_on %}<div class="tw-mb-1">{{ langs.products.general.from | t }}</div>{% endif %}
                    <div class="money">{{price_min | money_with_symbol}}</div>
                  </div>
                  <a href="/products/{{product.handle}}" class="tw-px-5 tw-py-2 tw-border-solid tw-leading-none tw-no-underline tw-text-btn-bg-color tw-bg-transparent tw-border tw-border-btn-bg-color tw-text-btn-font-size tw-tracking-btn-letter-spacing {%if settings.type_button_same_with == 'heading'%}type-heading-font-family{%else%}type-text-font-family{%endif%} {%if settings.type_button_text_uppercase_on%}tw-uppercase{%endif%} {%if settings.general_style == 'round'%}tw-rounded{%endif%}">
                    {{ langs.general.product.buy | t }}
                  </a>
                </div>
              {% endif %}
            </div>
          </div>
        {% endfor %}
      </div>
      {% if section.blocks.size > 4 %}
        <div class="tw-hidden lg:tw-block tw-opacity-0 lg:group-hover:tw-opacity-100 tw-absolute tw-z-10 tw-top-1/2 tw-left-6 lg:tw-left-7 tw-transform tw--translate-y-1/2 tw-cursor-pointer ins-{{section.id}}-pagination" data-direction="prev">
        {% include 'icon_bg_arrow', class: "tw-max-w-11 tw-max-h-11 tw-min-w-11 tw-min-h-11", icon_class: "tw-text-btn-bg-color" %}</div>
        <div class="tw-hidden lg:tw-block tw-opacity-0 lg:group-hover:tw-opacity-100 tw-absolute tw-z-10 tw-top-1/2 tw-right-6 lg:tw-right-7 tw-transform tw--translate-y-1/2 tw-cursor-pointer ins-{{section.id}}-pagination" data-direction="next">{% include 'icon_bg_arrow', class: "tw-max-w-11 tw-max-h-11 tw-min-w-11 tw-min-h-11", icon_class:"tw-transform tw-rotate-180 tw-text-btn-bg-color" %}</div>
      {% endif %}
    </div>
  </div>
</div>

{% javascript %}
  $(function(){
    $(document).on("click", ".ins-{{section.id}}-pagination", function () {
      var $container = $(".ins-{{section.id}}-container")
      var $list = $(".ins-{{section.id}}-list")
      var distance = $container.find(".ins-{{section.id}}-list > .ins-{{section.id}}-item:first").outerWidth();
      $list.stop().animate(
        { scrollLeft: $list.scrollLeft() + { prev: -1, next: 1 }[$(this).data("direction")] * distance },
        { duration: "150", easing: "linear" }
      );
    })
  })
{% endjavascript %}

{% schema %}
{
  "name": "instagram",
  "settings": [
    {
      "type": "header",
      "content": {
        "en-US": "Settings",
        "zh-CN": "设置"
      }
    },
    {
      "type": "text",
      "id": "title",
      "label": {
        "zh-CN": "标题",
        "en-US": "Heading"
      },
      "placeholder": {
        "en-US": "Input title",
        "zh-CN": "请输入标题"
      },
      "default": ""
    },
    {
      "type": "select",
      "id": "spacing",
      "label": {
        "en-US": "Space",
        "zh-CN": "格子间距"
      },
      "default": "20px",
      "options": [
        {
          "value": "15px",
          "label": {
            "en-US": "15px",
            "zh-CN": "15px"
          }
        },
        {
          "value": "20px",
          "label": {
            "en-US": "20px",
            "zh-CN": "20px"
          }
        },
        {
          "value": "30px",
          "label": {
            "en-US": "30px",
            "zh-CN": "30px"
          }
        },
        {
          "value": "40px",
          "label": {
            "en-US": "40px",
            "zh-CN": "40px"
          }
        }
      ]
    },
    {
      "type": "header",
      "content": {
        "en-US": "Typography",
        "zh-CN": "字体排版"
      }
    },
    {
      "type": "checkbox",
      "label": {
        "zh-CN": "开启标题全大写",
        "en-US": "Uppercase heading"
      },
      "id": "title_uppercase_on",
      "default": false
    },
    {
      "type": "range",
      "id": "title_font_size",
      "step": 1,
      "max": 48,
      "min": 12,
      "label": {
        "zh-CN": "标题字号",
        "en-US": "Heading text size"
      },
      "default": 28,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "title_letter_spacing",
      "step": 0.1,
      "max": 2,
      "min": -2,
      "label": {
        "zh-CN": "标题字间距",
        "en-US": "Heading letter spacing"
      },
      "default": 0
    },
    {
      "type": "header",
      "content": {
        "en-US": "Color",
        "zh-CN": "颜色"
      }
    },
    {
      "type": "color",
      "id": "color_section_bg",
      "label": {
        "en-US": "Background",
        "zh-CN": "背景"
      },
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "color_title_text",
      "label": {
        "zh-CN": "标题",
        "en-US": "Heading"
      },
      "default": "#000000"
    },
    {
      "type": "header",
      "content": {
        "en-US": "Layout",
        "zh-CN": "布局"
      }
    },
    {
      "type": "padding",
      "id": "padding",
      "label": {
        "en-US": "Content space",
        "zh-CN": "内容留白"
      },
      "default": {
        "top": "80",
        "right": "",
        "bottom": "80",
        "left": ""
      },
      "info": {
        "zh-CN": "内容留白单位为px",
        "en-US": "Content space unit in px"
      }
    },
    {
      "type": "text",
      "id": "max_container_width",
      "label": {
        "en-US": "Max content width",
        "zh-CN": "最大内容宽度"
      },
      "default": "",
      "props": {
        "type": "number"
      },
      "placeholder": {
        "zh-CN": "请输入最大内容宽度",
        "en-US": "Enter max content width"
      },
      "info": {
        "zh-CN": "最大内容宽度单位为px",
        "en-US": "Max content width unit in px"
      }
    },
    {
      "type": "header",
      "content": {
        "en-US": "Ins image",
        "zh-CN": "Ins图片"
      }
    }
  ],
  "max_blocks": 100,
  "blocks": [
    {
      "type": "content",
      "name": {
        "en-US": "Content",
        "zh-CN": "内容"
      },
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": {
            "en-US": "Image",
            "zh-CN": "图片"
          },
          "default": ""
        },
        {
          "type": "image_picker",
          "id": "avatar",
          "label": {
            "zh-CN": "头像",
            "en-US": "Profile photo"
          },
          "default": ""
        },
        {
          "type": "text",
          "id": "username",
          "label": {
            "en-US": "Username",
            "zh-CN": "用户名"
          },
          "placeholder": {
            "zh-CN": "请输入用户名",
            "en-US": "Enter username"
          },
          "default": ""
        },
        {
          "type": "product",
          "id": "product"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "instagram",
      "cname": {
        "en-US": "Instagram",
        "zh-CN": "Instagram"
      },
      "category": {
        "en-US": "Material",
        "zh-CN": "素材"
      },
      "ccategory": {
        "en-US": "Material",
        "zh-CN": "素材"
      },
      "blocks": [
        {
          "type": "content",
          "settings": {
            "image": "",
            "avatar": "",
            "username": "",
            "product": ""
          }
        },
        {
          "type": "content",
          "settings": {
            "image": "",
            "avatar": "",
            "username": "",
            "product": ""
          }
        },
        {
          "type": "content",
          "settings": {
            "image": "",
            "avatar": "",
            "username": "",
            "product": ""
          }
        },
        {
          "type": "content",
          "settings": {
            "image": "",
            "avatar": "",
            "username": "",
            "product": ""
          }
        }
      ],
      "icon": "oss/operation/61928f07ee94677c89164b5a2228a527.svg",
      "display": true
    }
  ]
}
{% endschema %}